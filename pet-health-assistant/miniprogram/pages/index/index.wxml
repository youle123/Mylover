<!--é¦–é¡µ-->
<view class="page">
  <!-- é¡¶éƒ¨ç”¨æˆ·ä¿¡æ¯ -->
  <view class="header">
    <view class="user-info">
      <image class="avatar" src="{{userInfo.avatarUrl || '/images/default-avatar.png'}}" mode="aspectFill"></image>
      <view class="user-text">
        <text class="greeting">{{greeting}}</text>
        <text class="username">{{userInfo.nickName || 'å® ç‰©ä¸»äºº'}}</text>
      </view>
    </view>
    <view class="weather" wx:if="{{weather}}">
      <text class="temperature">{{weather.temperature}}Â°</text>
      <text class="weather-desc">{{weather.description}}</text>
    </view>
  </view>

  <!-- å¿«é€Ÿæ“ä½œ -->
  <view class="quick-actions">
    <view class="action-item" bindtap="navigateToAddRecord">
      <view class="action-icon bg-primary">
        <text class="icon">+</text>
      </view>
      <text class="action-text">è®°å½•å¥åº·</text>
    </view>
    <view class="action-item" bindtap="navigateToAddReminder">
      <view class="action-icon bg-warning">
        <text class="icon">ğŸ””</text>
      </view>
      <text class="action-text">æ·»åŠ æé†’</text>
    </view>
    <view class="action-item" bindtap="navigateToAIAdvice">
      <view class="action-icon bg-info">
        <text class="icon">ğŸ¤–</text>
      </view>
      <text class="action-text">AIå»ºè®®</text>
    </view>
    <view class="action-item" bindtap="navigateToVetConsult">
      <view class="action-icon bg-success">
        <text class="icon">ğŸ‘©â€âš•ï¸</text>
      </view>
      <text class="action-text">åœ¨çº¿å’¨è¯¢</text>
    </view>
  </view>

  <!-- æˆ‘çš„å® ç‰© -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">æˆ‘çš„å® ç‰©</text>
      <text class="section-more" bindtap="navigateToPets">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>

    <view class="pets-container" wx:if="{{pets.length > 0}}">
      <swiper class="pets-swiper" indicator-dots="{{pets.length > 1}}" autoplay="{{false}}" circular="{{true}}">
        <swiper-item wx:for="{{pets}}" wx:key="id">
          <view class="pet-card" bindtap="onPetTap" data-pet="{{item}}">
            <image class="pet-avatar" src="{{item.avatar}}" mode="aspectFill"></image>
            <view class="pet-info">
              <text class="pet-name">{{item.name}}</text>
              <text class="pet-breed">{{item.breed}}</text>
              <text class="pet-age">{{item.age}}å²</text>
            </view>
          </view>
        </swiper-item>
      </swiper>
    </view>

    <view class="empty-pets" wx:else>
      <image class="empty-image" src="/images/empty-pet.png" mode="aspectFit"></image>
      <text class="empty-text">è¿˜æ²¡æœ‰æ·»åŠ å® ç‰©</text>
      <button class="btn btn-primary btn-small" bindtap="navigateToAddPet">æ·»åŠ ç¬¬ä¸€åªå® ç‰©</button>
    </view>
  </view>

  <!-- ä»Šæ—¥æé†’ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">ä»Šæ—¥æé†’</text>
      <text class="section-more" bindtap="navigateToReminders">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>

    <view class="reminders-list" wx:if="{{todayReminders.length > 0}}">
      <view class="reminder-card" wx:for="{{todayReminders}}" wx:key="id">
        <view class="reminder-icon">
          <text class="icon">{{item.icon}}</text>
        </view>
        <view class="reminder-content">
          <text class="reminder-title">{{item.title}}</text>
          <text class="reminder-time">{{item.time}}</text>
        </view>
        <button class="btn btn-small" bindtap="onReminderComplete" data-id="{{item.id}}">å®Œæˆ</button>
      </view>
    </view>

    <view class="empty-reminders" wx:else>
      <text class="empty-text">ä»Šå¤©æ²¡æœ‰æé†’äº‹é¡¹</text>
    </view>
  </view>

  <!-- å¥åº·æ¦‚è§ˆ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">å¥åº·æ¦‚è§ˆ</text>
      <text class="section-more" bindtap="navigateToHealthRecord">æŸ¥çœ‹è¯¦æƒ…</text>
    </view>

    <view class="health-overview" wx:if="{{currentPet}}">
      <view class="health-item">
        <view class="health-icon bg-primary">
          <text class="icon">âš–ï¸</text>
        </view>
        <view class="health-info">
          <text class="health-label">ä½“é‡</text>
          <text class="health-value">{{currentPet.weight || '--'}} kg</text>
        </view>
      </view>

      <view class="health-item">
        <view class="health-icon bg-success">
          <text class="icon">â¤ï¸</text>
        </view>
        <view class="health-info">
          <text class="health-label">å¥åº·çŠ¶æ€</text>
          <text class="health-value">{{currentPet.healthStatus || 'è‰¯å¥½'}}</text>
        </view>
      </view>

      <view class="health-item">
        <view class="health-icon bg-warning">
          <text class="icon">ğŸ“…</text>
        </view>
        <view class="health-info">
          <text class="health-label">ä¸‹æ¬¡ç–«è‹—</text>
          <text class="health-value">{{currentPet.nextVaccine || '--'}}</text>
        </view>
      </view>
    </view>

    <view class="empty-health" wx:else>
      <text class="empty-text">è¯·å…ˆæ·»åŠ å® ç‰©</text>
    </view>
  </view>

  <!-- ç¤¾åŒºåŠ¨æ€ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">ç¤¾åŒºåŠ¨æ€</text>
      <text class="section-more" bindtap="navigateToCommunity">è¿›å…¥ç¤¾åŒº</text>
    </view>

    <view class="community-posts" wx:if="{{communityPosts.length > 0}}">
      <view class="post-item" wx:for="{{communityPosts}}" wx:key="id" bindtap="navigateToPostDetail" data-id="{{item.id}}">
        <image class="post-avatar" src="{{item.author.avatar}}" mode="aspectFill"></image>
        <view class="post-content">
          <text class="post-author">{{item.author.name}}</text>
          <text class="post-text">{{item.content}}</text>
          <view class="post-meta">
            <text class="post-time">{{item.createTime}}</text>
            <view class="post-stats">
              <text class="stat-item">ğŸ‘ {{item.likes}}</text>
              <text class="stat-item">ğŸ’¬ {{item.comments}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>

    <view class="empty-community" wx:else>
      <text class="empty-text">æš‚æ— ç¤¾åŒºåŠ¨æ€</text>
    </view>
  </view>

  <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
  <view class="safe-area-bottom"></view>
</view>

<!-- åŠ è½½ç»„ä»¶ -->
<view class="loading" wx:if="{{loading}}">
  <text>åŠ è½½ä¸­...</text>
</view>
